---
title: "Exploratory Data Analysis"
author: "Felix EÃŸer"
date: "10/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exploratory Data Analysis and Data Screening

In advance to statistical (inferential) analyses, it is important to conduct exploratory data analysis (EDA) or data screening. Through EDA it is possible to get a *feeling* for the data, detect outliers, assess assumptions, etc. Additionally, analyses are performed in the `base R` framework and the `tidyverse` framework. Of course there are several packages to conduct these kind of analyses. In the following, the packages `skimr` and `psych` are used. The package `skimr` can be used in conjuction with the `tidyverse` framework and is kableable. In contrast, the package `psych` provides additional statistics. There are a bunch of packages which can be used to conduct basic descriptive statistics like `pastecs`, `Hmisc`, `summarytools`, and surely others. 

### Packages and datasets

```{r load packages, message=FALSE}
library(magrittr) # for %$% and %T>% pipe
library(tidyverse) # data manipulation and plots
library(psych)
library(skimr)
```

Throughout the dataset `mtcars` is used to demonstrate the proposed concepts. 
```{r data}
data("mtcars") # from tidyverse package
mtcars <- mtcars %>% as_tibble() %>% 
  # manipulate tibble to obtain different classes of columns
  mutate(vs = factor(vs, labels = c("v-shaped", "straight")),
         character = rep(c("A", "B"), length.out = nrow(mtcars)))
```

The variables mean the following:

| Variable Name | Meaning |
|---------------|---------|
| mpg	 | Miles/(US) gallon |
| cyl	 | Number of cylinders |
| disp |	Displacement (cu.in.) |
| hp	 | Gross horsepower |
| drat |	Rear axle ratio |
| wt	 | Weight (1000 lbs) |
| qsec |	1/4 mile time |
| vs   | Engine (0 = V-shaped, 1 = straight) |
| am   | Transmission (0 = automatic, 1 = manual) |
| gear |	Number of forward gears |
| carb |	Number of carburetors |

## Univariate Exploratory Data Analysis
This is used to check the accuracy of the input. 

## Quick Exploratory Data Analysis on the whole dataset

### `Base R` approach
In `base R` the `summary()` function can be used:
```{r base R}
summary(mtcars)
```

### `skimR` approach

The function `skim` can be used in pipes and can itself be the input of a pipe in which case the summary data can be further manipulated.

```{r skim}
mtcars %>% 
  group_by(am) %>% # skim recognises grouped tibbles
  skim()
```

With the function `skim_tee()` it is possible to obtain an output from a pipe but use the data in a further pipeline. 
Using the function `skim_with()` additional/other statistics can be calculated. However, this procedure is a bit unconvenient as `skim_with()` is a closure and returns therefore a function which has to be assigned.
```{r skim_with}
skim_median <- skim_with(numeric = sfl(median), # sfl = skimmer_function_list
                         append = FALSE) # no default statistics
skim_median(mtcars)
```

### `psych` approach

Using the function `describe` from the package `psych` results more easily in additional statistics.
```{r describe}
mtcars %>% 
  select(mpg, vs, character) %>% 
  describe() 
```

The output of the `describe()` function can be used in further pipes. The advantage is that statistics regarding the distribution are given (skew and kurtosis).
To obtain descriptive statistics by group, the function `describeBy()` can be used. As can be seen, the output of the `describeBy` function is not well knitable.
```{r describeBy}
mtcars %>% 
  select(mpg, vs, am) %>% 
  describeBy(group = .$am) # short: describeBy(mtcars ~ am)
```


## Measures of Central Tendency
Measures of central tendency are the mode, median and mean. In addition, the weighted mean, the geometric mean and the harmonic mean are explained. 

There is no `base R` function for the **mode** (most frequent manifestation of a variable). Therefore the `table()` function is used to obtain the frequencies.
```{r mode alternative}
table(mtcars$vs)
```
**Median** and **mean** are calculated via the respective functions.
```{r median and mean}
mtcars %>% 
  summarise(Median_mpg = median(mtcars$mpg),
            Mean_mpg = mean(mtcars$mpg))
```

In case the goal is to average values from different groups with a differing number of observations, the **weighted mean** is the appropriate measure. Therefore the 
```{r weighted mean}
mtcars %$% # the %$% pipe explodes the dataframe-name like the with() function
  weighted.mean(x = mpg, w = gear)
```

The calculation of the **geometric mean** requires at least ratio scale (has an absolute zero point and no numbers exist below zero). The geometric mean is the $n$-th root of the product of all values from all cases $m$:
$$ \overline{x}_{geom} = \sqrt[n]{\prod_{m = 1}^{n} x_m} $$

In `R` is no built-in function, but the package `psych` offers the function `geometric.mean()`:
```{r geometric mean}
geometric.mean(mtcars$mpg)
```

The geometric mean is useful for describing non-normal distributions and suits as a measure of central tendency if the difference between values is better described through their ratio rather than their difference. For example, this is the case for growth rates. The average of growth rates is calculated with the geometric mean. 
An geometric explanation: Imagine a rectangle with the dimensions $9m*4m = 36m^2$. The geometric mean describes the side length of a square posessing the same area. 


The **harmonic mean** is the reciprocal of the arithmetic mean of the reciprocals:
$$ \overline{x}_{harm} = \frac{n}{\Sigma_{m = 1}^{n} \frac{1}{x_m}} $$
Likewise to the geometric mean, there is no built-in function for the **harmonic mean** but the `psych` package offers the function `harmonic.mean()`:
```{r harmonic mean}
harmonic.mean(mtcars$qsec)
```
The harmonic mean is used in case of rates, like speed over fixed distances instead of times. In the latter case the arithmetic mean can be used. 


## Measures of dispersion


## Assumption of normality


## Bi- and Multivariate Exploratory Data Analysis

```{r marida}
marida()
```



## Missing data

